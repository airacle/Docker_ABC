<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3-dev">
<meta name="author" content="gudaoxuri ">
<title>Docker ABC</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary {
    display: block;
}

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video {
    display: inline-block;
}

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) {
    display: none;
    height: 0;
}

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template {
    display: none;
}

script {
    display: none !important;
}

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html {
    font-family: sans-serif; /* 1 */
    -ms-text-size-adjust: 100%; /* 2 */
    -webkit-text-size-adjust: 100%; /* 2 */
}

/** Remove default margin. */
body {
    margin: 0;
}

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a {
    background: transparent;
}

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus {
    outline: thin dotted;
}

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover {
    outline: 0;
}

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] {
    border-bottom: 1px dotted;
}

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong {
    font-weight: bold;
}

/** Address styling not present in Safari 5 and Chrome. */
dfn {
    font-style: italic;
}

/** Address differences between Firefox and other browsers. */
hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/** Address styling not present in IE 8/9. */
mark {
    background: #ff0;
    color: #000;
}

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp {
    font-family: monospace, serif;
    font-size: 1em;
}

/** Improve readability of pre-formatted text in all browsers. */
pre {
    white-space: pre-wrap;
}

/** Set consistent quote types. */
q {
    quotes: "\201C" "\201D" "\2018" "\2019";
}

/** Address inconsistent and variable font size in all browsers. */
small {
    font-size: 80%;
}

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img {
    border: 0;
}

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) {
    overflow: hidden;
}

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure {
    margin: 0;
}

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend {
    border: 0; /* 1 */
    padding: 0; /* 2 */
}

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea {
    font-family: inherit; /* 1 */
    font-size: 100%; /* 2 */
    margin: 0; /* 3 */
}

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input {
    line-height: normal;
}

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select {
    text-transform: none;
}

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
}

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] {
    cursor: default;
}

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
}

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table {
    border-collapse: collapse;
    border-spacing: 0;
}

meta.foundation-mq-small {
    font-family: "only screen and (min-width: 768px)";
    width: 768px;
}

meta.foundation-mq-medium {
    font-family: "only screen and (min-width:1280px)";
    width: 1280px;
}

meta.foundation-mq-large {
    font-family: "only screen and (min-width:1440px)";
    width: 1440px;
}

*, *:before, *:after {
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
}

html, body {
    font-size: 100%;
}

body {
    background: white;
    color: rgba(0, 0, 0, 0.8);
    padding: 0;
    margin: 0;
    font-family: "Noto Serif", "DejaVu Serif", serif;
    font-weight: normal;
    font-style: normal;
    line-height: 1;
    position: relative;
    cursor: auto;
}

a:hover {
    cursor: pointer;
}

img, object, embed {
    max-width: 100%;
    height: auto;
}

object, embed {
    height: 100%;
}

img {
    -ms-interpolation-mode: bicubic;
}

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object {
    max-width: none !important;
}

.left {
    float: left !important;
}

.right {
    float: right !important;
}

.text-left {
    text-align: left !important;
}

.text-right {
    text-align: right !important;
}

.text-center {
    text-align: center !important;
}

.text-justify {
    text-align: justify !important;
}

.hide {
    display: none;
}

.antialiased, body {
    -webkit-font-smoothing: antialiased;
}

img {
    display: inline-block;
    vertical-align: middle;
}

textarea {
    height: auto;
    min-height: 50px;
}

select {
    width: 100%;
}

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
    font-size: 1.21875em;
    line-height: 1.6;
}

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
    line-height: 1.45;
    color: #7a2518;
    font-weight: normal;
    margin-top: 0;
    margin-bottom: 0.25em;
}

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td {
    margin: 0;
    padding: 0;
    direction: ltr;
}

/* Default Link Styles */
a {
    color: #2156a5;
    text-decoration: underline;
    line-height: inherit;
}

a:hover, a:focus {
    color: #1d4b8f;
}

a img {
    border: none;
}

/* Default paragraph styles */
p {
    font-family: inherit;
    font-weight: normal;
    font-size: 1em;
    line-height: 1.6;
    margin-bottom: 1.25em;
    text-rendering: optimizeLegibility;
}

p aside {
    font-size: 0.875em;
    line-height: 1.35;
    font-style: italic;
}

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    font-weight: 300;
    font-style: normal;
    color: #ba3925;
    text-rendering: optimizeLegibility;
    margin-top: 1em;
    margin-bottom: 0.5em;
    line-height: 1.0125em;
}

h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small {
    font-size: 60%;
    color: #e99b8f;
    line-height: 0;
}

h1 {
    font-size: 2.125em;
}

h2 {
    font-size: 1.6875em;
}

h3, #toctitle, .sidebarblock > .content > .title {
    font-size: 1.375em;
}

h4 {
    font-size: 1.125em;
}

h5 {
    font-size: 1.125em;
}

h6 {
    font-size: 1em;
}

hr {
    border: solid #ddddd8;
    border-width: 1px 0 0;
    clear: both;
    margin: 1.25em 0 1.1875em;
    height: 0;
}

/* Helpful Typography Defaults */
em, i {
    font-style: italic;
    line-height: inherit;
}

strong, b {
    font-weight: bold;
    line-height: inherit;
}

small {
    font-size: 60%;
    line-height: inherit;
}

code {
    font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace;
    font-weight: normal;
    color: rgba(0, 0, 0, 0.9);
}

/* Lists */
ul, ol, dl {
    font-size: 1em;
    line-height: 1.6;
    margin-bottom: 1.25em;
    list-style-position: outside;
    font-family: inherit;
}

ul, ol {
    margin-left: 1.5em;
}

ul.no-bullet, ol.no-bullet {
    margin-left: 1.5em;
}

/* Unordered Lists */
ul li ul, ul li ol {
    margin-left: 1.25em;
    margin-bottom: 0;
    font-size: 1em; /* Override nested font-size change */
}

ul.square li ul, ul.circle li ul, ul.disc li ul {
    list-style: inherit;
}

ul.square {
    list-style-type: square;
}

ul.circle {
    list-style-type: circle;
}

ul.disc {
    list-style-type: disc;
}

ul.no-bullet {
    list-style: none;
}

/* Ordered Lists */
ol li ul, ol li ol {
    margin-left: 1.25em;
    margin-bottom: 0;
}

/* Definition Lists */
dl dt {
    margin-bottom: 0.3125em;
    font-weight: bold;
}

dl dd {
    margin-bottom: 1.25em;
}

/* Abbreviations */
abbr, acronym {
    text-transform: uppercase;
    font-size: 90%;
    color: rgba(0, 0, 0, 0.8);
    border-bottom: 1px dotted #dddddd;
    cursor: help;
}

abbr {
    text-transform: none;
}

/* Blockquotes */
blockquote {
    margin: 0 0 1.25em;
    padding: 0.5625em 1.25em 0 1.1875em;
    border-left: 1px solid #dddddd;
}

blockquote cite {
    display: block;
    font-size: 0.9375em;
    color: rgba(0, 0, 0, 0.6);
}

blockquote cite:before {
    content: "\2014 \0020";
}

blockquote cite a, blockquote cite a:visited {
    color: rgba(0, 0, 0, 0.6);
}

blockquote, blockquote p {
    line-height: 1.6;
    color: rgba(0, 0, 0, 0.85);
}

/* Microformats */
.vcard {
    display: inline-block;
    margin: 0 0 1.25em 0;
    border: 1px solid #dddddd;
    padding: 0.625em 0.75em;
}

.vcard li {
    margin: 0;
    display: block;
}

.vcard .fn {
    font-weight: bold;
    font-size: 0.9375em;
}

.vevent .summary {
    font-weight: bold;
}

.vevent abbr {
    cursor: auto;
    text-decoration: none;
    font-weight: bold;
    border: none;
    padding: 0 0.0625em;
}

@media only screen and (min-width: 768px) {
    h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
        line-height: 1.2;
    }

    h1 {
        font-size: 2.75em;
    }

    h2 {
        font-size: 2.3125em;
    }

    h3, #toctitle, .sidebarblock > .content > .title {
        font-size: 1.6875em;
    }

    h4 {
        font-size: 1.4375em;
    }
}

/* Tables */
table {
    background: white;
    margin-bottom: 1.25em;
    border: solid 1px #dedede;
}

table thead, table tfoot {
    background: #f7f8f7;
    font-weight: bold;
}

table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
    padding: 0.5em 0.625em 0.625em;
    font-size: inherit;
    color: rgba(0, 0, 0, 0.8);
    text-align: left;
}

table tr th, table tr td {
    padding: 0.5625em 0.625em;
    font-size: inherit;
    color: rgba(0, 0, 0, 0.8);
}

table tr.even, table tr.alt, table tr:nth-of-type(even) {
    background: #f8f8f7;
}

table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
    display: table-cell;
    line-height: 1.6;
}

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
    line-height: 1.2;
    word-spacing: -0.05em;
}

h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong {
    font-weight: 400;
}

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after {
    content: " ";
    display: table;
}

.clearfix:after, .float-group:after {
    clear: both;
}

*:not(pre) > code {
    font-size: 0.9375em;
    font-style: normal !important;
    letter-spacing: 0;
    padding: 0.1em 0.5ex;
    word-spacing: -0.15em;
    background-color: #f7f7f8;
    -webkit-border-radius: 4px;
    border-radius: 4px;
    line-height: 1.45;
    text-rendering: optimizeSpeed;
}

pre, pre > code {
    line-height: 1.45;
    color: rgba(0, 0, 0, 0.9);
    font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace;
    font-weight: normal;
    text-rendering: optimizeSpeed;
}

.keyseq {
    color: rgba(51, 51, 51, 0.8);
}

kbd {
    display: inline-block;
    color: rgba(0, 0, 0, 0.8);
    font-size: 0.75em;
    line-height: 1.4;
    background-color: #f7f7f7;
    border: 1px solid #ccc;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset;
    margin: -0.15em 0.15em 0 0.15em;
    padding: 0.2em 0.6em 0.2em 0.5em;
    vertical-align: middle;
    white-space: nowrap;
}

.keyseq kbd:first-child {
    margin-left: 0;
}

.keyseq kbd:last-child {
    margin-right: 0;
}

.menuseq, .menu {
    color: rgba(0, 0, 0, 0.8);
}

b.button:before, b.button:after {
    position: relative;
    top: -1px;
    font-weight: normal;
}

b.button:before {
    content: "[";
    padding: 0 3px 0 2px;
}

b.button:after {
    content: "]";
    padding: 0 2px 0 3px;
}

p a > code:hover {
    color: rgba(0, 0, 0, 0.9);
}

#header, #content, #footnotes, #footer {
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    margin-top: 0;
    margin-bottom: 0;
    max-width: 62.5em;
    *zoom: 1;
    position: relative;
    padding-left: 0.9375em;
    padding-right: 0.9375em;
}

#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after {
    content: " ";
    display: table;
}

#header:after, #content:after, #footnotes:after, #footer:after {
    clear: both;
}

#content {
    margin-top: 1.25em;
}

#content:before {
    content: none;
}

#header > h1:first-child {
    color: rgba(0, 0, 0, 0.85);
    margin-top: 2.25rem;
    margin-bottom: 0;
}

#header > h1:first-child + #toc {
    margin-top: 8px;
    border-top: 1px solid #ddddd8;
}

#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) {
    border-bottom: 1px solid #ddddd8;
    padding-bottom: 8px;
}

#header .details {
    border-bottom: 1px solid #ddddd8;
    line-height: 1.45;
    padding-top: 0.25em;
    padding-bottom: 0.25em;
    padding-left: 0.25em;
    color: rgba(0, 0, 0, 0.6);
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-flow: row wrap;
    -webkit-flex-flow: row wrap;
    flex-flow: row wrap;
}

#header .details span:first-child {
    margin-left: -0.125em;
}

#header .details span.email a {
    color: rgba(0, 0, 0, 0.85);
}

#header .details br {
    display: none;
}

#header .details br + span:before {
    content: "\00a0\2013\00a0";
}

#header .details br + span.author:before {
    content: "\00a0\22c5\00a0";
    color: rgba(0, 0, 0, 0.85);
}

#header .details br + span#revremark:before {
    content: "\00a0|\00a0";
}

#header #revnumber {
    text-transform: capitalize;
}

#header #revnumber:after {
    content: "\00a0";
}

#content > h1:first-child:not([class]) {
    color: rgba(0, 0, 0, 0.85);
    border-bottom: 1px solid #ddddd8;
    padding-bottom: 8px;
    margin-top: 0;
    padding-top: 1rem;
    margin-bottom: 1.25rem;
}

#toc {
    border-bottom: 1px solid #efefed;
    padding-bottom: 0.5em;
}

#toc > ul {
    margin-left: 0.125em;
}

#toc ul.sectlevel0 > li > a {
    font-style: italic;
}

#toc ul.sectlevel0 ul.sectlevel1 {
    margin: 0.5em 0;
}

#toc ul {
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    list-style-type: none;
}

#toc a {
    text-decoration: none;
}

#toc a:active {
    text-decoration: underline;
}

#toctitle {
    color: #7a2518;
    font-size: 1.2em;
}

@media only screen and (min-width: 768px) {
    #toctitle {
        font-size: 1.375em;
    }

    body.toc2 {
        padding-left: 15em;
        padding-right: 0;
    }

    #toc.toc2 {
        margin-top: 0 !important;
        background-color: #f8f8f7;
        position: fixed;
        width: 15em;
        left: 0;
        top: 0;
        border-right: 1px solid #efefed;
        border-top-width: 0 !important;
        border-bottom-width: 0 !important;
        z-index: 1000;
        padding: 1.25em 1em;
        height: 100%;
        overflow: auto;
    }

    #toc.toc2 #toctitle {
        margin-top: 0;
        font-size: 1.2em;
    }

    #toc.toc2 > ul {
        font-size: 0.9em;
        margin-bottom: 0;
    }

    #toc.toc2 ul ul {
        margin-left: 0;
        padding-left: 1em;
    }

    #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
        padding-left: 0;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
    }

    body.toc2.toc-right {
        padding-left: 0;
        padding-right: 15em;
    }

    body.toc2.toc-right #toc.toc2 {
        border-right-width: 0;
        border-left: 1px solid #efefed;
        left: auto;
        right: 0;
    }
}

@media only screen and (min-width: 1280px) {
    body.toc2 {
        padding-left: 20em;
        padding-right: 0;
    }

    #toc.toc2 {
        width: 20em;
    }

    #toc.toc2 #toctitle {
        font-size: 1.375em;
    }

    #toc.toc2 > ul {
        font-size: 0.95em;
    }

    #toc.toc2 ul ul {
        padding-left: 1.25em;
    }

    body.toc2.toc-right {
        padding-left: 0;
        padding-right: 20em;
    }
}

#content #toc {
    border-style: solid;
    border-width: 1px;
    border-color: #e0e0dc;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f8f8f7;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

#content #toc > :first-child {
    margin-top: 0;
}

#content #toc > :last-child {
    margin-bottom: 0;
}

#footer {
    max-width: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    padding: 1.25em;
}

#footer-text {
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.44;
}

.sect1 {
    padding-bottom: 0.625em;
}

@media only screen and (min-width: 768px) {
    .sect1 {
        padding-bottom: 1.25em;
    }
}

.sect1 + .sect1 {
    border-top: 1px solid #efefed;
}

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor {
    position: absolute;
    z-index: 1001;
    width: 1.5ex;
    margin-left: -1.5ex;
    display: block;
    text-decoration: none !important;
    visibility: hidden;
    text-align: center;
    font-weight: normal;
}

#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before {
    content: "\00A7";
    font-size: 0.85em;
    display: block;
    padding-top: 0.1em;
}

#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover {
    visibility: visible;
}

#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link {
    color: #ba3925;
    text-decoration: none;
}

#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover {
    color: #a53221;
}

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock {
    margin-bottom: 1.25em;
}

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
    text-rendering: optimizeLegibility;
    text-align: left;
    font-family: "Noto Serif", "DejaVu Serif", serif;
    font-size: 1rem;
    font-style: italic;
}

table.tableblock > caption.title {
    white-space: nowrap;
    overflow: visible;
    max-width: 0;
}

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
    color: rgba(0, 0, 0, 0.85);
}

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p {
    font-size: inherit;
}

.admonitionblock > table {
    border-collapse: separate;
    border: 0;
    background: none;
    width: 100%;
}

.admonitionblock > table td.icon {
    text-align: center;
    width: 80px;
}

.admonitionblock > table td.icon img {
    max-width: none;
}

.admonitionblock > table td.icon .title {
    font-weight: bold;
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    text-transform: uppercase;
}

.admonitionblock > table td.content {
    padding-left: 1.125em;
    padding-right: 1.25em;
    border-left: 1px solid #ddddd8;
    color: rgba(0, 0, 0, 0.6);
}

.admonitionblock > table td.content > :last-child > :last-child {
    margin-bottom: 0;
}

.exampleblock > .content {
    border-style: solid;
    border-width: 1px;
    border-color: #e6e6e6;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: white;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

.exampleblock > .content > :first-child {
    margin-top: 0;
}

.exampleblock > .content > :last-child {
    margin-bottom: 0;
}

.sidebarblock {
    border-style: solid;
    border-width: 1px;
    border-color: #e0e0dc;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f8f8f7;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

.sidebarblock > :first-child {
    margin-top: 0;
}

.sidebarblock > :last-child {
    margin-bottom: 0;
}

.sidebarblock > .content > .title {
    color: #7a2518;
    margin-top: 0;
    text-align: center;
}

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child {
    margin-bottom: 0;
}

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint {
    background: #f7f7f8;
}

.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint {
    background: #f2f1f1;
}

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
    -webkit-border-radius: 4px;
    border-radius: 4px;
    word-wrap: break-word;
    padding: 1em;
    font-size: 0.8125em;
}

.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap {
    overflow-x: auto;
    white-space: pre;
    word-wrap: normal;
}

@media only screen and (min-width: 768px) {
    .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
        font-size: 0.90625em;
    }
}

@media only screen and (min-width: 1280px) {
    .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
        font-size: 1em;
    }
}

.literalblock.output pre {
    color: #f7f7f8;
    background-color: rgba(0, 0, 0, 0.9);
}

.listingblock pre.highlightjs {
    padding: 0;
}

.listingblock pre.highlightjs > code {
    padding: 1em;
    -webkit-border-radius: 4px;
    border-radius: 4px;
}

.listingblock pre.prettyprint {
    border-width: 0;
}

.listingblock > .content {
    position: relative;
}

.listingblock code[data-lang]:before {
    display: none;
    content: attr(data-lang);
    position: absolute;
    font-size: 0.75em;
    top: 0.425rem;
    right: 0.5rem;
    line-height: 1;
    text-transform: uppercase;
    color: #999;
}

.listingblock:hover code[data-lang]:before {
    display: block;
}

.listingblock.terminal pre .command:before {
    content: attr(data-prompt);
    padding-right: 0.5em;
    color: #999;
}

.listingblock.terminal pre .command:not([data-prompt]):before {
    content: "$";
}

table.pyhltable {
    border-collapse: separate;
    border: 0;
    margin-bottom: 0;
    background: none;
}

table.pyhltable td {
    vertical-align: top;
    padding-top: 0;
    padding-bottom: 0;
}

table.pyhltable td.code {
    padding-left: .75em;
    padding-right: 0;
}

pre.pygments .lineno, table.pyhltable td:not(.code) {
    color: #999;
    padding-left: 0;
    padding-right: .5em;
    border-right: 1px solid #ddddd8;
}

pre.pygments .lineno {
    display: inline-block;
    margin-right: .25em;
}

table.pyhltable .linenodiv {
    background: none !important;
    padding-right: 0 !important;
}

.quoteblock {
    margin: 0 1em 1.25em 1.5em;
    display: table;
}

.quoteblock > .title {
    margin-left: -1.5em;
    margin-bottom: 0.75em;
}

.quoteblock blockquote, .quoteblock blockquote p {
    color: rgba(0, 0, 0, 0.85);
    font-size: 1.15rem;
    line-height: 1.75;
    word-spacing: 0.1em;
    letter-spacing: 0;
    font-style: italic;
    text-align: justify;
}

.quoteblock blockquote {
    margin: 0;
    padding: 0;
    border: 0;
}

.quoteblock blockquote:before {
    content: "\201c";
    float: left;
    font-size: 2.75em;
    font-weight: bold;
    line-height: 0.6em;
    margin-left: -0.6em;
    color: #7a2518;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.quoteblock blockquote > .paragraph:last-child p {
    margin-bottom: 0;
}

.quoteblock .attribution {
    margin-top: 0.5em;
    margin-right: 0.5ex;
    text-align: right;
}

.quoteblock .quoteblock {
    margin-left: 0;
    margin-right: 0;
    padding: 0.5em 0;
    border-left: 3px solid rgba(0, 0, 0, 0.6);
}

.quoteblock .quoteblock blockquote {
    padding: 0 0 0 0.75em;
}

.quoteblock .quoteblock blockquote:before {
    display: none;
}

.verseblock {
    margin: 0 1em 1.25em 1em;
}

.verseblock pre {
    font-family: "Open Sans", "DejaVu Sans", sans;
    font-size: 1.15rem;
    color: rgba(0, 0, 0, 0.85);
    font-weight: 300;
    text-rendering: optimizeLegibility;
}

.verseblock pre strong {
    font-weight: 400;
}

.verseblock .attribution {
    margin-top: 1.25rem;
    margin-left: 0.5ex;
}

.quoteblock .attribution, .verseblock .attribution {
    font-size: 0.9375em;
    line-height: 1.45;
    font-style: italic;
}

.quoteblock .attribution br, .verseblock .attribution br {
    display: none;
}

.quoteblock .attribution cite, .verseblock .attribution cite {
    display: block;
    letter-spacing: -0.05em;
    color: rgba(0, 0, 0, 0.6);
}

.quoteblock.abstract {
    margin: 0 0 1.25em 0;
    display: block;
}

.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p {
    text-align: left;
    word-spacing: 0;
}

.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before {
    display: none;
}

table.tableblock {
    max-width: 100%;
    border-collapse: separate;
}

table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child {
    margin-bottom: 0;
}

table.spread {
    width: 100%;
}

table.tableblock, th.tableblock, td.tableblock {
    border: 0 solid #dedede;
}

table.grid-all th.tableblock, table.grid-all td.tableblock {
    border-width: 0 1px 1px 0;
}

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock {
    border-width: 1px 1px 0 0;
}

table.grid-cols th.tableblock, table.grid-cols td.tableblock {
    border-width: 0 1px 0 0;
}

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child {
    border-right-width: 0;
}

table.grid-rows th.tableblock, table.grid-rows td.tableblock {
    border-width: 0 0 1px 0;
}

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock {
    border-bottom-width: 0;
}

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock {
    border-width: 1px 0 0 0;
}

table.frame-all {
    border-width: 1px;
}

table.frame-sides {
    border-width: 0 1px;
}

table.frame-topbot {
    border-width: 1px 0;
}

th.halign-left, td.halign-left {
    text-align: left;
}

th.halign-right, td.halign-right {
    text-align: right;
}

th.halign-center, td.halign-center {
    text-align: center;
}

th.valign-top, td.valign-top {
    vertical-align: top;
}

th.valign-bottom, td.valign-bottom {
    vertical-align: bottom;
}

th.valign-middle, td.valign-middle {
    vertical-align: middle;
}

table thead th, table tfoot th {
    font-weight: bold;
}

tbody tr th {
    display: table-cell;
    line-height: 1.6;
    background: #f7f8f7;
}

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
    color: rgba(0, 0, 0, 0.8);
    font-weight: bold;
}

p.tableblock > code:only-child {
    background: none;
    padding: 0;
}

p.tableblock {
    font-size: 1em;
}

td > div.verse {
    white-space: pre;
}

ol {
    margin-left: 1.75em;
}

ul li ol {
    margin-left: 1.5em;
}

dl dd {
    margin-left: 1.125em;
}

dl dd:last-child, dl dd:last-child > :last-child {
    margin-bottom: 0;
}

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist {
    margin-bottom: 0.625em;
}

ul.unstyled, ol.unnumbered, ul.checklist, ul.none {
    list-style-type: none;
}

ul.unstyled, ol.unnumbered, ul.checklist {
    margin-left: 0.625em;
}

ul.checklist li > p:first-child > .fa-check-square-o:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
    margin-right: 0.25em;
}

ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
    position: relative;
    top: 1px;
}

ul.inline {
    margin: 0 auto 0.625em auto;
    margin-left: -1.375em;
    margin-right: 0;
    padding: 0;
    list-style: none;
    overflow: hidden;
}

ul.inline > li {
    list-style: none;
    float: left;
    margin-left: 1.375em;
    display: block;
}

ul.inline > li > * {
    display: block;
}

.unstyled dl dt {
    font-weight: normal;
    font-style: normal;
}

ol.arabic {
    list-style-type: decimal;
}

ol.decimal {
    list-style-type: decimal-leading-zero;
}

ol.loweralpha {
    list-style-type: lower-alpha;
}

ol.upperalpha {
    list-style-type: upper-alpha;
}

ol.lowerroman {
    list-style-type: lower-roman;
}

ol.upperroman {
    list-style-type: upper-roman;
}

ol.lowergreek {
    list-style-type: lower-greek;
}

.hdlist > table, .colist > table {
    border: 0;
    background: none;
}

.hdlist > table > tbody > tr, .colist > table > tbody > tr {
    background: none;
}

td.hdlist1 {
    padding-right: .75em;
    font-weight: bold;
}

td.hdlist1, td.hdlist2 {
    vertical-align: top;
}

.literalblock + .colist, .listingblock + .colist {
    margin-top: -0.5em;
}

.colist > table tr > td:first-of-type {
    padding: 0 0.75em;
    line-height: 1;
}

.colist > table tr > td:last-of-type {
    padding: 0.25em 0;
}

.thumb, .th {
    line-height: 0;
    display: inline-block;
    border: solid 4px white;
    -webkit-box-shadow: 0 0 0 1px #dddddd;
    box-shadow: 0 0 0 1px #dddddd;
}

.imageblock.left, .imageblock[style*="float: left"] {
    margin: 0.25em 0.625em 1.25em 0;
}

.imageblock.right, .imageblock[style*="float: right"] {
    margin: 0.25em 0 1.25em 0.625em;
}

.imageblock > .title {
    margin-bottom: 0;
}

.imageblock.thumb, .imageblock.th {
    border-width: 6px;
}

.imageblock.thumb > .title, .imageblock.th > .title {
    padding: 0 0.125em;
}

.image.left, .image.right {
    margin-top: 0.25em;
    margin-bottom: 0.25em;
    display: inline-block;
    line-height: 0;
}

.image.left {
    margin-right: 0.625em;
}

.image.right {
    margin-left: 0.625em;
}

a.image {
    text-decoration: none;
}

span.footnote, span.footnoteref {
    vertical-align: super;
    font-size: 0.875em;
}

span.footnote a, span.footnoteref a {
    text-decoration: none;
}

span.footnote a:active, span.footnoteref a:active {
    text-decoration: underline;
}

#footnotes {
    padding-top: 0.75em;
    padding-bottom: 0.75em;
    margin-bottom: 0.625em;
}

#footnotes hr {
    width: 20%;
    min-width: 6.25em;
    margin: -.25em 0 .75em 0;
    border-width: 1px 0 0 0;
}

#footnotes .footnote {
    padding: 0 0.375em;
    line-height: 1.3;
    font-size: 0.875em;
    margin-left: 1.2em;
    text-indent: -1.2em;
    margin-bottom: .2em;
}

#footnotes .footnote a:first-of-type {
    font-weight: bold;
    text-decoration: none;
}

#footnotes .footnote:last-of-type {
    margin-bottom: 0;
}

#content #footnotes {
    margin-top: -0.625em;
    margin-bottom: 0;
    padding: 0.75em 0;
}

.gist .file-data > table {
    border: 0;
    background: #fff;
    width: 100%;
    margin-bottom: 0;
}

.gist .file-data > table td.line-data {
    width: 99%;
}

div.unbreakable {
    page-break-inside: avoid;
}

.big {
    font-size: larger;
}

.small {
    font-size: smaller;
}

.underline {
    text-decoration: underline;
}

.overline {
    text-decoration: overline;
}

.line-through {
    text-decoration: line-through;
}

.aqua {
    color: #00bfbf;
}

.aqua-background {
    background-color: #00fafa;
}

.black {
    color: black;
}

.black-background {
    background-color: black;
}

.blue {
    color: #0000bf;
}

.blue-background {
    background-color: #0000fa;
}

.fuchsia {
    color: #bf00bf;
}

.fuchsia-background {
    background-color: #fa00fa;
}

.gray {
    color: #606060;
}

.gray-background {
    background-color: #7d7d7d;
}

.green {
    color: #006000;
}

.green-background {
    background-color: #007d00;
}

.lime {
    color: #00bf00;
}

.lime-background {
    background-color: #00fa00;
}

.maroon {
    color: #600000;
}

.maroon-background {
    background-color: #7d0000;
}

.navy {
    color: #000060;
}

.navy-background {
    background-color: #00007d;
}

.olive {
    color: #606000;
}

.olive-background {
    background-color: #7d7d00;
}

.purple {
    color: #600060;
}

.purple-background {
    background-color: #7d007d;
}

.red {
    color: #bf0000;
}

.red-background {
    background-color: #fa0000;
}

.silver {
    color: #909090;
}

.silver-background {
    background-color: #bcbcbc;
}

.teal {
    color: #006060;
}

.teal-background {
    background-color: #007d7d;
}

.white {
    color: #bfbfbf;
}

.white-background {
    background-color: #fafafa;
}

.yellow {
    color: #bfbf00;
}

.yellow-background {
    background-color: #fafa00;
}

span.icon > .fa {
    cursor: default;
}

.admonitionblock td.icon [class^="fa icon-"] {
    font-size: 2.5em;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    cursor: default;
}

.admonitionblock td.icon .icon-note:before {
    content: "\f05a";
    color: #19407c;
}

.admonitionblock td.icon .icon-tip:before {
    content: "\f0eb";
    text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8);
    color: #111;
}

.admonitionblock td.icon .icon-warning:before {
    content: "\f071";
    color: #bf6900;
}

.admonitionblock td.icon .icon-caution:before {
    content: "\f06d";
    color: #bf3400;
}

.admonitionblock td.icon .icon-important:before {
    content: "\f06a";
    color: #bf0000;
}

.conum[data-value] {
    display: inline-block;
    color: #fff !important;
    background-color: rgba(0, 0, 0, 0.8);
    -webkit-border-radius: 100px;
    border-radius: 100px;
    text-align: center;
    font-size: 0.75em;
    width: 1.67em;
    height: 1.67em;
    line-height: 1.67em;
    font-family: "Open Sans", "DejaVu Sans", sans-serif;
    font-style: normal;
    font-weight: bold;
}

.conum[data-value] * {
    color: #fff !important;
}

.conum[data-value] + b {
    display: none;
}

.conum[data-value]:after {
    content: attr(data-value);
}

pre .conum[data-value] {
    position: relative;
    top: -0.125em;
}

b.conum * {
    color: inherit !important;
}

.conum:not([data-value]):empty {
    display: none;
}

h1, h2 {
    letter-spacing: -0.01em;
}

dt, th.tableblock, td.content {
    text-rendering: optimizeLegibility;
}

p, td.content {
    letter-spacing: -0.01em;
}

p strong, td.content strong {
    letter-spacing: -0.005em;
}

p, blockquote, dt, td.content {
    font-size: 1.0625rem;
}

p {
    margin-bottom: 1.25rem;
}

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock {
    font-size: 1em;
}

.exampleblock > .content {
    background-color: #fffef7;
    border-color: #e0e0dc;
    -webkit-box-shadow: 0 1px 4px #e0e0dc;
    box-shadow: 0 1px 4px #e0e0dc;
}

.print-only {
    display: none !important;
}

@media print {
    @page {
        margin: 1.25cm 0.75cm;
    }

    * {
        -webkit-box-shadow: none !important;
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a {
        color: inherit !important;
        text-decoration: underline !important;
    }

    a.bare, a[href^="#"], a[href^="mailto:"] {
        text-decoration: none !important;
    }

    a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after, a[href^="mailto:"]:not(.bare):after {
        content: "(" attr(href) ")";
        display: inline-block;
        font-size: 0.875em;
        padding-left: 0.25em;
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    pre, blockquote, tr, img {
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group;
    }

    img {
        max-width: 100% !important;
    }

    p, blockquote, dt, td.content {
        font-size: 1em;
        orphans: 3;
        widows: 3;
    }

    h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title {
        page-break-after: avoid;
    }

    #toc, .sidebarblock, .exampleblock > .content {
        background: none !important;
    }

    #toc {
        border-bottom: 1px solid #ddddd8 !important;
        padding-bottom: 0 !important;
    }

    .sect1 {
        padding-bottom: 0 !important;
    }

    .sect1 + .sect1 {
        border: 0 !important;
    }

    #header > h1:first-child {
        margin-top: 1.25rem;
    }

    body.book #header {
        text-align: center;
    }

    body.book #header > h1:first-child {
        border: 0 !important;
        margin: 2.5em 0 1em 0;
    }

    body.book #header .details {
        border: 0 !important;
        display: block;
        padding: 0 !important;
    }

    body.book #header .details span:first-child {
        margin-left: 0 !important;
    }

    body.book #header .details br {
        display: block;
    }

    body.book #header .details br + span:before {
        content: none !important;
    }

    body.book #toc {
        border: 0 !important;
        text-align: left !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 {
        page-break-before: always;
    }

    .listingblock code[data-lang]:before {
        display: block;
    }

    #footer {
        background: none !important;
        padding: 0 0.9375em;
    }

    #footer-text {
        color: rgba(0, 0, 0, 0.6) !important;
        font-size: 0.9em;
    }

    .hide-on-print {
        display: none !important;
    }

    .print-only {
        display: block !important;
    }

    .hide-for-print {
        display: none !important;
    }

    .show-for-print {
        display: inherit !important;
    }
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Docker ABC</h1>
<div class="details">
<span id="author" class="author">gudaoxuri </span><br>
<span id="email" class="email"><a href="mailto:i@sunisle.org">i@sunisle.org</a></span><br>
<span id="revnumber">version 1.0.0,</span>
<span id="revdate">Nov 6, 2015</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#true-">1. 序言</a></li>
<li><a href="#true--2">2. 版权说明</a></li>
<li><a href="#true--3">3. 贡献者</a></li>
<li><a href="#true-docker">4. 什么是Docker</a>
<ul class="sectlevel2">
<li><a href="#true--4">4.1. 权威解释</a></li>
<li><a href="#true--5">4.2. 通俗地说&#8230;&#8203;</a></li>
</ul>
</li>
<li><a href="#true--6">5. 核心概念</a></li>
<li><a href="#true--7">6. 基础</a>
<ul class="sectlevel2">
<li><a href="#true-mysql">6.1. 获取MySQL镜像</a></li>
<li><a href="#true--8">6.2. 查看本机镜像</a></li>
<li><a href="#true-mysql-2">6.3. 运行MySQL镜像</a></li>
<li><a href="#true--9">6.4. 查看本机容器</a></li>
<li><a href="#true-mysql-3">6.5. 删除MySQL容器</a></li>
<li><a href="#true-mysql-4">6.6. 停止/运行/重启MySQL容器</a></li>
<li><a href="#true--10">6.7. 完成</a></li>
</ul>
</li>
<li><a href="#true--11">7. 进阶</a>
<ul class="sectlevel2">
<li><a href="#true-redis">7.1. 获取Redis镜像并运行</a></li>
<li><a href="#true-mysql-5">7.2. 获取MySQL镜像并运行</a></li>
<li><a href="#true--12">7.3. 创建相应的数据库及权限</a></li>
<li><a href="#true-gitlab">7.4. 获取Gitlab镜像</a></li>
<li><a href="#true-gitlab-2">7.5. 运行Gitlab镜像</a></li>
<li><a href="#true--13">7.6. 查看运行日志</a></li>
<li><a href="#true--14">7.7. 完成</a></li>
</ul>
</li>
<li><a href="#true--15">8. 高级</a>
<ul class="sectlevel2">
<li><a href="#true--16">8.1. 构建镜像的两种方法</a></li>
<li><a href="#truedockerfile">8.2. Dockerfile介绍</a></li>
<li><a href="#true--17">8.3. 构建规划</a></li>
<li><a href="#truessh">8.4. SSH镜像</a></li>
<li><a href="#true-ssh">8.5. 编译SSH镜像</a></li>
<li><a href="#truejava">8.6. Java镜像</a></li>
<li><a href="#truescala">8.7. Scala镜像</a></li>
<li><a href="#true-java-scala">8.8. 编译Java/Scala镜像</a></li>
<li><a href="#true--18">8.9. 发布镜像</a>
<ul class="sectlevel3">
<li><a href="#true-github">8.9.1. 使用github发布镜像</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--19">9. 网络</a></li>
<li><a href="#true--20">10. 生态系统</a>
<ul class="sectlevel2">
<li><a href="#truedocker-toolbox">10.1. Docker Toolbox</a></li>
<li><a href="#truekitematic">10.2. Kitematic</a></li>
<li><a href="#truepipework">10.3. pipework</a></li>
<li><a href="#truedocker-swarm">10.4. Docker Swarm</a></li>
</ul>
</li>
<li><a href="#true--21">11. 热点问题</a>
<ul class="sectlevel2">
<li><a href="#true-ip">11.1. 容器如何使用静态IP</a></li>
<li><a href="#true-a-id-qanda-add-port-to-alive-container-a">11.2. 如何为运行中的容器增加访问端口<a id="qanda-add-port-to-alive-container"></a></a></li>
<li><a href="#true-docker-ip">11.3. 让Docker容器使用静态独立的外部IP（便于集群组建）</a></li>
</ul>
</li>
<li><a href="#true--22">12. 附</a></li>
<li><a href="#true--23">13. 索引</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="true-"><a class="anchor" href="#true-"></a>1. 序言</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/docker.png" alt="docker.png">
</div>
</div>
<div class="paragraph">
<p>Docker可谓是当下炙手可热的工具，如同Java当然提出的 “Write once, run anywhere” 类似 Docker所能实现的是 “Building once run anywhere” ,这是一个伟大的创举，当然Java的一个理念却被NodeJS打脸，这是后话。</p>
</div>
<div class="paragraph">
<p>这段时间要组织公司的Docker的培训，正好做个知识沉淀，故写此<code>快餐书</code>，与世面上众多的Docker书籍相比，本书希望做到的是从速入门、上手、实战，关注怎么使用，对于背后的原理不会做这多的涉及。</p>
</div>
<div class="paragraph">
<p><em>gudaoxuri @ asto</em></p>
</div>
<div class="paragraph">
<p><em>2015-11-06</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--2"><a class="anchor" href="#true--2"></a>2. 版权说明</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Copyleft</strong> ！</p>
</div>
<div class="paragraph">
<p>您可以自由使用、散布、改作，但也请保持开源共享。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--3"><a class="anchor" href="#true--3"></a>3. 贡献者</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. 贡献者名单</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">贡献者</th>
<th class="tableblock halign-left valign-top">所属</th>
<th class="tableblock halign-left valign-top">内容</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gudaoxuri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">杭州阿思拓电子商务有限公司</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">建立文档</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="true-docker"><a class="anchor" href="#true-docker"></a>4. 什么是Docker</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--4"><a class="anchor" href="#true--4"></a>4.1. 权威解释</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Docker is an open platform for building, shipping and running distributed applications. It gives programmers, development teams and operations engineers the common toolbox they need to take advantage of the distributed and networked nature of modern applications.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; docker.com
</div>
</div>
<div class="paragraph">
<p>这是来自Docker官网的说明，其中有两层意思：</p>
</div>
<div class="qlist qanda">
<ol>
<li>
<p><em>docker可以干什么？</em></p>
<p>它可以用于编译（building）、分发（shipping）、运行（running）分布式应用。</p>
</li>
<li>
<p><em>谁用docker？</em></p>
<p>程序员（programmers）、开发团队（development teams）、运维工程师（operations engineers）。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="true--5"><a class="anchor" href="#true--5"></a>4.2. 通俗地说&#8230;&#8203;</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
这货就是精简版的VM虚拟机，在牺牲了一定的资源隔离性的情况下实现了极小的资源占用、极快地启动/停止，它可以方便地共享/获取公共应用（镜像），通过<code>Dockfile</code>更可以方便地构建自己的应用（镜像）。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>延伸阅读： <a href="http://stackoverflow.com/questions/16047306/how-is-docker-different-from-a-normal-virtual-machine">Docker与VM的区别</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--6"><a class="anchor" href="#true--6"></a>5. 核心概念</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在正式使用Docker前我们先简述几个核心概念。</p>
</div>
<div class="paragraph">
<p><strong>Image（镜像）</strong></p>
</div>
<div class="paragraph">
<p>与我们熟知的<code>Windows</code>镜像（ISO或安装光盘）类似，可以理解为一份特定应用的Copy，它是只读的。</p>
</div>
<div class="paragraph">
<p><strong>Container（容器）</strong></p>
</div>
<div class="paragraph">
<p>镜像是不能直接运行的，只有安装后才能使用，容器就是这个运行镜像后的实例，我们可以修改实例。</p>
</div>
<div class="paragraph">
<p><strong>Dockerfile</strong></p>
</div>
<div class="paragraph">
<p>用于制作镜像的元文件，有点类似<code>Maven</code>的<code>pom.xml</code>文件，可以通过它构建一个镜像。</p>
</div>
<div class="paragraph">
<p><strong>hub.docker.com</strong></p>
</div>
<div class="paragraph">
<p>镜像发布共享的地方，与<code>search.maven.org</code>类似。</p>
</div>
<div class="paragraph">
<p>它们之间的关系如下：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/concept.png" alt="concept.png">
</div>
<div class="title">Figure 1. 关系</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--7"><a class="anchor" href="#true--7"></a>6. 基础</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>本节我们以运行<code>MySQL</code>实例为例，介绍基础使用。</p>
</div>
</blockquote>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
使用 <code>docker --help</code> 查看支持的所有命令
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="true-mysql"><a class="anchor" href="#true-mysql"></a>6.1. 获取MySQL镜像</h3>
<div class="ulist">
<ul>
<li>
<p>首先我们从<code>hub.docker.com</code>上获取<code>MySQL</code>镜像</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>这里有两种方式，一是使用  <code>search</code>命令：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker search mysql
NAME                       DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                      MySQL is a widely used, open-source relati...   1253      [OK]
mariadb                    MariaDB is a community-developed fork of M...   280       [OK]
mysql/mysql-server         Optimized MySQL Server Docker images. Crea...   58                   [OK]
centurylink/mysql          Image containing mysql. Optimized to be li...   29                   [OK]
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>另外我们也可以在网页上查询更详细的说明：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/basic_mysql_search.png" alt="basic mysql search.png">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>STARS</code> 表示收藏的数量，<code>PULLS</code>表示下载的数量，<code>OFFICIAL</code>表示是官方镜像（此处表示是否是MySQL官方发布）
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>我们下载第一个官方的镜像 </p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker pull mysql
Pulling repository mysql
196db1908492: Download complete
575489a51992: Download complete
...
Status: Downloaded newer image for mysql:latest</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Docker镜像的命名格式 <code>&lt;用户名，官方镜像不需要/&gt;镜像名称&lt;/版本号&gt;</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--8"><a class="anchor" href="#true--8"></a>6.2. 查看本机镜像</h3>
<div class="ulist">
<ul>
<li>
<p>查看本机的所有镜像 </p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker images
REPOSITORY             TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
mysql                  5.7                 196db1908492        6 days ago          359.8 MB
mysql                  5.7.9               196db1908492        6 days ago          359.8 MB
mysql                  latest              196db1908492        6 days ago          359.8 MB
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true-mysql-2"><a class="anchor" href="#true-mysql-2"></a>6.3. 运行MySQL镜像</h3>
<div class="ulist">
<ul>
<li>
<p>运行<code>MySQL</code>镜像 </p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker run --name app1-db -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7
2dee953f85d697ffcb78ac795f06e1a22731ae373b154178ea6220ce9b9c6e04</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>--name</code> 指定容器名称，<code>-e</code> 指定特殊的一些变量，<code>-d</code> 表示后台运行（服务化）
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--9"><a class="anchor" href="#true--9"></a>6.4. 查看本机容器</h3>
<div class="ulist">
<ul>
<li>
<p>查看本机的所有在运行容器 </p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker ps
CONTAINER ID        IMAGE      COMMAND                CREATED             STATUS        PORTS     NAMES
2dee953f85d6        mysql:5    "/entrypoint.sh mysq   6 seconds ago       Up 5 seconds  3306/tcp  app1-db</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>docker ps -a</code>   可以查看所有容器（包含没有运行的）
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>然后呢，怎么连接？我们需要一个IP和端口，但上面的运行并没有对外暴露端口，所以我们要重新运行一个容器</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Docker目前（v1.7）还不支持为容器绑定端口，如有此需求请查看<a href="#qanda-add-port-to-alive-container">如何为运行中的容器增加访问端口</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true-mysql-3"><a class="anchor" href="#true-mysql-3"></a>6.5. 删除MySQL容器</h3>
<div class="ulist">
<ul>
<li>
<p>我们先删除刚才的容器</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker rm -f app1-db
app1-db</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>-f</code> 表示强制删除运行中的容器
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
这会删除容器中的所有数据。不科学呀？那我想删除容器时保留某些数据（如这里的数据库文件）怎么办？我们往下看：
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>重新运行<code>MySQL</code>镜像</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker run --name app1-db -e MYSQL_ROOT_PASSWORD=123456 -d -p 3308:3306 -v /opt/mysql_data:/var/lib/mysql mysql:5.7
1add96f289a1b8744500a4a6709af6e2e0628b97797e8470be75efe67e2005f4</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>-p</code>表示将外部访问的3308端口映射到容器的3306端口，由于<code>MySQL</code>镜像默认允许对外开放3306端口（我为什么知道？看它的<code>dockerfile</code>，后面会有说明），所以也可以直接用<code>-P</code>,这样的话外部访问3306也被映射到容器的3306端口上
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>-v</code>参数可以宿主机的目录映射到将容器内目录，上例<code>-v /opt/mysql_data:/var/lib/mysql</code>会将宿主机<code>/opt/mysql_data</code>映射到容器<code>/var/lib/mysql</code>(已知此目录为MySQL的数据目录)，这样可以保证容器删除时对应目录的数据不被删除（因为这个目录是宿主机上的），这点很重要，实际使用中几乎所有容器都要做此映射！
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>有了端口之后那IP呢？IP实际上就是你docker宿主机的IP</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Docker的访问机制简单说明：Docker所有的对外服务统一使用<code>宿主机IP+特定端口</code>，当一个请求发起时会经由宿主面的iptables根据容器创建时的端口规则转发到对应的容器处理。
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>好了，现在我们做个连接测试，通过</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/basic_mysql_connect.png" alt="basic mysql connect.png">
</div>
</div>
</div>
<div class="sect2">
<h3 id="true-mysql-4"><a class="anchor" href="#true-mysql-4"></a>6.6. 停止/运行/重启MySQL容器</h3>
<div class="ulist">
<ul>
<li>
<p>当然我们也可以对容器做<code>停止/运行/重启</code>   操作：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker stop app1-db
app1-db
root@ubuntu:~# docker start app1-db
app1-db
root@ubuntu:~# docker restart app1-db
app1-db</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--10"><a class="anchor" href="#true--10"></a>6.7. 完成</h3>
<div class="paragraph">
<p><code>MySQL</code>容器如何升级/数据如何备份都方式都可以在 <code><a href="https://hub.docker.com/_/mysql/" class="bare">https://hub.docker.com/_/mysql/</a></code> 获取到指导。</p>
</div>
<div class="paragraph">
<p>至此，我们基础使用就介绍完了！</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--11"><a class="anchor" href="#true--11"></a>7. 进阶</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>本节我们以运行<code>Gitlab</code>实例为例，进一步介绍Docker的常规使用。</p>
</div>
</blockquote>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
上节<code>MySQL</code>是独立的镜像，没有依赖，但<code>Gitlab</code>会依赖数据库及缓存，我们看看容器间如何交互。<code>Gitlab</code>有官方镜像，但我更喜欢<code>sameersbn</code>的版本，这个版本介绍详细，并且作者一直在持续更新。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="true-redis"><a class="anchor" href="#true-redis"></a>7.1. 获取Redis镜像并运行</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker pull redis
...
root@ubuntu:~# docker run --name gitlab-cache -d redis
a2c183f16cee0aa30eca8f27875d3770ac1291fc22b218d4b5e673ce604074c8</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true-mysql-5"><a class="anchor" href="#true-mysql-5"></a>7.2. 获取MySQL镜像并运行</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# mkdir -p /opt/test/gitlab/db/ <i class="conum" data-value="1"></i><b>(1)</b>
root@ubuntu:~# docker pull mysql
...
root@ubuntu:~# docker run --name gitlab-db -e MYSQL_ROOT_PASSWORD=123456 -d -p 3307:3306 -v /opt/test/gitlab/db:/var/lib/mysql mysql:5.7
7c8110b8151e2ddbc67d2bb1d96a9cc24ef68546a885d065e78bd274775ec7f7</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>创建数据库目录映射</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--12"><a class="anchor" href="#true--12"></a>7.3. 创建相应的数据库及权限</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker exec -it gitlab-db /bin/bash
root@7c8110b8151e:/# mysql -uroot -p123456
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.7.9 MySQL Community Server (GPL)

Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; CREATE USER 'gitlab'@'%.%.%.%' IDENTIFIED BY 'password';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; CREATE DATABASE IF NOT EXISTS `gitlabhq_production` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`;
Query OK, 1 row affected (0.00 sec)

mysql&gt; GRANT ALL PRIVILEGES ON `gitlabhq_production`.* TO 'gitlab'@'%.%.%.%';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; exit
Bye
root@7c8110b8151e:/# exit
exit</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>exec</code>  表示进入一个运行中的容器
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
MySQL中执行的语句见： <a href="https://hub.docker.com/r/sameersbn/gitlab/#external-mysql-server" class="bare">https://hub.docker.com/r/sameersbn/gitlab/#external-mysql-server</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true-gitlab"><a class="anchor" href="#true-gitlab"></a>7.4. 获取Gitlab镜像</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# mkdir -p /opt/test/gitlab/data <i class="conum" data-value="1"></i><b>(1)</b>
root@ubuntu:~# docker pull sameersbn/gitlab</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>创建GIT数据目录映射</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true-gitlab-2"><a class="anchor" href="#true-gitlab-2"></a>7.5. 运行Gitlab镜像</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker run --name=gitlab -d \
 -e GITLAB_PORT=10080 \ <i class="conum" data-value="1"></i><b>(1)</b>
 -e GITLAB_SSH_PORT=10022 \ <i class="conum" data-value="2"></i><b>(2)</b>
 -e GITLAB_HOST=inner.ecfront.com \ <i class="conum" data-value="3"></i><b>(3)</b>
 -e DB_TYPE=mysql \ <i class="conum" data-value="4"></i><b>(4)</b>
 -e DB_HOST=192.168.4.99 \
 -e DB_PORT=3307 \
 -e DB_NAME=gitlabhq_production \
 -e DB_USER=gitlab \
 -e DB_PASS=password \
 -e GITLAB_EMAIL=git@ecfront.com \ <i class="conum" data-value="5"></i><b>(5)</b>
 -e SMTP_ENABLED=true \
 -e SMTP_DOMAIN=ecfront.com \
 -e SMTP_HOST=smtp.exmail.qq.com \
 -e SMTP_PORT=25 \
 -e SMTP_USER=git@ecfront.com \
 -e SMTP_PASS=xxx \
 -e SMTP_AUTHENTICATION=login \
 -e NGINX_MAX_UPLOAD_SIZE=512m \ <i class="conum" data-value="6"></i><b>(6)</b>
 -e GITLAB_BACKUPS=monthly \ <i class="conum" data-value="7"></i><b>(7)</b>
 -p 10022:22 \ <i class="conum" data-value="8"></i><b>(8)</b>
 -p 10080:80 \ <i class="conum" data-value="9"></i><b>(9)</b>
 -v /opt/test/gitlab/data:/home/git/data \ <i class="conum" data-value="10"></i><b>(10)</b>
 --link gitlab-cache:redisio \ <i class="conum" data-value="11"></i><b>(11)</b>
 --dns=192.168.4.99 \ <i class="conum" data-value="12"></i><b>(12)</b>
 sameersbn/gitlab</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>HTTP服务端口</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>SSH请求端口</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>服务域名</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>数据库连接信息</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Email信息</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>解决<code>RPC failed; result=22, HTTP code = 413</code>问题，见 <a href="http://stackoverflow.com/questions/7489813/github-push-error-rpc-failed-result-22-http-code-413" class="bare">http://stackoverflow.com/questions/7489813/github-push-error-rpc-failed-result-22-http-code-413</a></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>备份策略，每天</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>SSH请求端口映射</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>HTTP请求端口映射</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>GIT数据目录映射</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>连接Reids容器，实现缓存</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>配置DNS</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
如果使用MySQL数据库一定要加上<code>-e DB_TYPE=mysql</code>否则这个容器会以默认的Postgre类型去连接导致无法启动
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>--dns</code> 用于指定容器的DNS，我们可以指定一个公共DNS以实现不同容器互PING
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Docker默认情况下容器间是不能互访的，要实现交互主要有两种途径，一是用<code>--link</code>这也是Docker推荐的做法，它会在容器中建立被Link容器的Host记录实现单向访问，另一种是开放服务实现调用，对于上述案例，Redis使用的是Link方式，MySQL使用是开放服务方式。
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>访问一下：<code><a href="http://192.168.4.99:10080" class="bare">http://192.168.4.99:10080</a></code> (192.168.4.99是我宿主机的IP)，等等，为什么访问不了？</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="true--13"><a class="anchor" href="#true--13"></a>7.6. 查看运行日志</h3>
<div class="ulist">
<ul>
<li>
<p>在出问题时我们首先想到的是 <strong>去看看日志</strong> ,Docker容器运行日志的查看如下：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:~# docker logs gitlab
ERROR:
  Please configure the GITLAB_SECRETS_DB_KEY_BASE parameter.
  Cannot continue. Aborting...</code></pre>
</div>
</div>
<div class="paragraph">
<p>提示是需要<code>GITLAB_SECRETS_DB_KEY_BASE</code>变量，查看官方说明：</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong>: Since GitLab <code>8.0.0</code> you need to provide the <code>GITLAB_SECRETS_DB_KEY_BASE</code> parameter while starting the image.</p>
</div>
<div class="paragraph">
<p><strong>Tip</strong>: You can generate a random string using <code>pwgen -Bsv1 64</code> and assign it as the value of<code>GITLAB_SECRETS_DB_KEY_BASE</code>.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; https://hub.docker.com/r/sameersbn/gitlab/
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>好的，我们用<code>pwgen -Bsv1 64</code>生成一个密钥</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>root@ubuntu:~# pwgen -Bsv1 64
7hpTqCXgf4tVbnFmdC7PNn9n4hWmCnvF479fsJtcdTkhmVfWfzpwTJ4sNRzNkkXf</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>把<code>GITLAB_SECRETS_DB_KEY_BASE</code>加上重新运行</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>root@ubuntu:~# docker rm -f gitlab
root@ubuntu:~# docker run --name=gitlab -d \
 -e GITLAB_PORT=10080 \
 -e GITLAB_SSH_PORT=10022 \
 -e GITLAB_HOST=inner.ecfront.com \
 -e DB_TYPE=mysql \
 -e DB_HOST=192.168.4.99 \
 -e DB_PORT=3307 \
 -e DB_NAME=gitlabhq_production \
 -e DB_USER=gitlab \
 -e DB_PASS=password \
 -e GITLAB_SECRETS_DB_KEY_BASE=7hpTqCXgf4tVbnFmdC7PNn9n4hWmCnvF479fsJtcdTkhmVfWfzpwTJ4sNRzNkkXf \
 -e GITLAB_EMAIL=git@ecfront.com \
 -e SMTP_ENABLED=true \
 -e SMTP_DOMAIN=ecfront.com \
 -e SMTP_HOST=smtp.exmail.qq.com \
 -e SMTP_PORT=25 \
 -e SMTP_USER=git@ecfront.com \
 -e SMTP_PASS=xxx \
 -e SMTP_AUTHENTICATION=login \
 -e NGINX_MAX_UPLOAD_SIZE=512m \
 -e GITLAB_BACKUPS=monthly \
 -p 10022:22 \
 -p 10080:80 \
 -v /opt/test/gitlab/data:/home/git/data \
 --link gitlab-cache:redisio \
 --dns=192.168.4.99 \
 sameersbn/gitlab</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--14"><a class="anchor" href="#true--14"></a>7.7. 完成</h3>
<div class="ulist">
<ul>
<li>
<p>好了，第一次要做的事情比较多，过一会就可以打开页面了</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/advanced_result.png" alt="advanced result.png">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
用户名：root 密码：5iveL!fe
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--15"><a class="anchor" href="#true--15"></a>8. 高级</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>本节我介绍如何自己构建一个Docker镜像，我们将构建一个支持scala的运行（ <a href="http://www.scala-lang.org" class="bare">http://www.scala-lang.org</a> ）环境，并且对外开放SSH服务。</p>
</div>
</blockquote>
</div>
<div class="sect2">
<h3 id="true--16"><a class="anchor" href="#true--16"></a>8.1. 构建镜像的两种方法</h3>
<div class="paragraph">
<p>构建镜像有两种方法：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>运行并进行一个基础容器（如centos ， <code>docker run -it centos /bin/bash</code>），然后安装需要的环境，再用<code>commit</code>  将容器保存成新的镜像</p>
</li>
<li>
<p>使用<code>Dockerfile</code>构建，这也是推荐的做法</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>本节我们仅介绍第2种方法。</p>
</div>
</div>
<div class="sect2">
<h3 id="truedockerfile"><a class="anchor" href="#truedockerfile"></a>8.2. Dockerfile介绍</h3>
<div class="paragraph">
<p>Dokcerfile是用于构建Docker镜像的元文件，它的说明及语法见： <a href="http://docs.docker.com/engine/reference/builder/" class="bare">http://docs.docker.com/engine/reference/builder/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="true--17"><a class="anchor" href="#true--17"></a>8.3. 构建规划</h3>
<div class="paragraph">
<p>根据需求可以发现我们安装的主要环境有三个：SSH服务、Java环境（Scala依赖它）、Scala环境，与软件开发一样，我们也可以<code>分模块</code>构建，即构建三个镜像：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>只包含SSH服务的基础镜像</p>
</li>
<li>
<p>带SSH及Java环境的镜像</p>
</li>
<li>
<p>带SSH、Java及Scala环境的镜像</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="truessh"><a class="anchor" href="#truessh"></a>8.4. SSH镜像</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-script" data-lang="script">FROM centos:centos7 <i class="conum" data-value="1"></i><b>(1)</b>
MAINTAINER gudaoxuri <i class="conum" data-value="2"></i><b>(2)</b>

#---------------Use 163 mirrors-------------<i class="conum" data-value="3"></i><b>(3)</b>
RUN yum install -y wget &amp;&amp;\
    mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup &amp;&amp; \
    wget -P /etc/yum.repos.d/ http://mirrors.163.com/.help/CentOS7-Base-163.repo &amp;&amp; \
    yum clean all &amp;&amp; \
    yum makecache <i class="conum" data-value="4"></i><b>(4)</b>

#---------------Install Common Tools---------------
RUN yum install -y sed curl tar gcc gcc-c++ make git passwd sudo

#---------------Modify Time Zone---------------
ENV TZ "Asia/Shanghai" <i class="conum" data-value="5"></i><b>(5)</b>
ENV TERM xterm

RUN yum install -y ntpdate  &amp;&amp; \
    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

#---------------Support Chinese---------------
#RUN yum groupinstall -y "Fonts"  &amp;&amp; \
#    echo "LANG=\"zh_CN.UTF-8\"" &gt;&gt; /etc/sysconfig/i18n

#---------------Install SSH---------------
RUN yum install -y openssh-server openssh-clients  &amp;&amp; \
    sed -i 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config  &amp;&amp; \
    echo 'root:123456' | chpasswd  &amp;&amp; \
    ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key  &amp;&amp; \
    ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key  &amp;&amp; \
    mkdir /var/run/sshd

#---------------Setting Common Path---------------
RUN chmod 777 -R /opt/  &amp;&amp; \
    mkdir /opt/env/  &amp;&amp; \
    mkdir /opt/workspaces/

EXPOSE 22 <i class="conum" data-value="6"></i><b>(6)</b>

CMD ["/usr/sbin/sshd", "-D"] <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td> <code>FROM</code> 表示此镜像是基于哪个镜像构建的</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td> <code>MAINTAINER</code> 开发者的信息</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>  # 注释</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td> <code>RUN</code> 常用命令，用于执行Linux的命令，多用于安装组件</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td> <code>ENV</code> 常用命令，用于设置环境变量</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td> <code>EXPOSE</code> 表明默认对外暴露的端口(<code>docker run -P</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td> <code>CMD</code> 要执行的服务，多条<code>CMD</code>只执行最后一条</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>RUN</code> 参数的学问，Docker镜像是分层的，一个镜像可能由多个层组成，一次<code>RUN</code>实际上就产生了一层，在编译<code>Dockerfile</code>的过程中可能出错，重新编译时我们会发现之前已成功编译的层不会再次被编译
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true-ssh"><a class="anchor" href="#true-ssh"></a>8.5. 编译SSH镜像</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">root@ubuntu:/opt/test/dockerfile/ssh# ls
Dockerfile
root@ubuntu:/opt/test/dockerfile/ssh# docker build -t gudaoxuri/ssh .
Sending build context to Docker daemon 3.072 kB
Sending build context to Docker daemon
Step 0 : FROM centos:centos7
Pulling repository centos
ce20c473cd8a: Download complete
ce20c473cd8a: Pulling image (centos7) from centos
168a69b62202: Download complete
812e9d9d677f: Download complete
4234bfdd88f8: Download complete
Status: Downloaded newer image for centos:centos7
 ---&gt; ce20c473cd8a
Step 1 : MAINTAINER gudaoxuri
 ---&gt; Running in 889ea744c458
 ---&gt; 5b1151e6cb0b
Removing intermediate container 889ea744c458

...

Step 10 : CMD /usr/sbin/sshd -D
 ---&gt; Running in ce563073b686
 ---&gt; b61a4adad85f
Removing intermediate container ce563073b686
Successfully built b61a4adad85f

root@ubuntu:/opt/test/dockerfile/ssh# docker images
REPOSITORY             TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
gudaoxuri/ssh          latest              b61a4adad85f        10 minutes ago      966 MB
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truejava"><a class="anchor" href="#truejava"></a>8.6. Java镜像</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-script" data-lang="script">FROM gudaoxuri/ssh:latest <i class="conum" data-value="1"></i><b>(1)</b>
MAINTAINER gudaoxuri

#---------------Install Java---------------
RUN wget -P /opt/env/ --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie"  http://download.oracle.com/otn-pub/java/jdk/8u60-b27/jdk-8u60-linux-x64.tar.gz  &amp;&amp; \
    tar -xzf /opt/env/jdk-8u60-linux-x64.tar.gz -C /opt/env/  &amp;&amp; \
    rm /opt/env/jdk-8u60-linux-x64.tar.gz  &amp;&amp; \
    mv /opt/env/jdk1.8.0_60 /opt/env/java  &amp;&amp; \
    echo "export JAVA_HOME=/opt/env/java" &gt;&gt; /etc/profile
ENV  JAVA_HOME /opt/env/java

RUN echo 'PATH=$PATH:$JAVA_HOME/bin' &gt;&gt; /etc/profile
ENV PATH $PATH:$JAVA_HOME/bin</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>gudaoxuri/ssh:latest</code> 就是我们之前编译的镜像</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truescala"><a class="anchor" href="#truescala"></a>8.7. Scala镜像</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-script" data-lang="script">FROM gudaoxuri/java:latest
MAINTAINER gudaoxuri

#---------------Install Scala---------------
RUN wget -P /opt/env/ http://downloads.typesafe.com/scala/2.10.6/scala-2.10.6.tgz  &amp;&amp; \
    tar -xzf /opt/env/scala-2.10.6.tgz -C /opt/env/  &amp;&amp; \
    rm /opt/env/scala-2.10.6.tgz  &amp;&amp; \
    mv /opt/env/scala-2.10.6 /opt/env/scala  &amp;&amp; \
    echo "export SCALA_HOME=/opt/env/scala" &gt;&gt; /etc/profile
ENV SCALA_HOME /opt/env/scala

RUN sed /^PATH=/d /etc/profile &gt;&gt; /etc/profile &amp;&amp; \
   echo 'PATH=$PATH:$JAVA_HOME/bin:$SCALA_HOME/bin' &gt;&gt; /etc/profile
ENV PATH $PATH:$JAVA_HOME/bin:$SCALA_HOME/bin</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true-java-scala"><a class="anchor" href="#true-java-scala"></a>8.8. 编译Java/Scala镜像</h3>
<div class="paragraph">
<p>过程同上，略</p>
</div>
</div>
<div class="sect2">
<h3 id="true--18"><a class="anchor" href="#true--18"></a>8.9. 发布镜像</h3>
<div class="paragraph">
<p>有了新的镜像后我们希望把这个镜像发布到<code>hub.docker.com</code>上去分享，有两种方式：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>使用 <code>docker push</code> 发布前要先登录  <code>docker login</code></p>
</li>
<li>
<p>使用<code>github</code>发布</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
介于国内网络环境恶劣，第1种方式失败概率很高，因为它上传的是生成的镜像（几百MB到几G不等），所以推荐使用第2种方式
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
请先注册<code>hub.docker.com</code> 及 <code>github.com</code> 的账号
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="true-github"><a class="anchor" href="#true-github"></a>8.9.1. 使用github发布镜像</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
不要用<code>IE</code>操作，笔者使用<code>IE11</code>在<code>hub.docker.com</code>上操作时发生过不小的困扰。
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>hub.docker.com</code> 上建立<code>github</code>连接</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_link.png" alt="deep publish link.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>github</code>中设置权限</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_git_auth.png" alt="deep publish git auth.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>github</code>中建一个开源项目，注意要包含<code>Dockerfile</code>文件</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_create_git.png" alt="deep publish create git.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>github</code>中设置这个项目的权限</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_git_auth2.png" alt="deep publish git auth2.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>hub.docker.com</code> 上建立自动构建项目</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_create_auto.png" alt="deep publish create auto.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>hub.docker.com</code> 上选择<code>github</code>上的项目</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_select_git.png" alt="deep publish select git.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在<code>hub.docker.com</code> 上设置项目属性</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_create_image.png" alt="deep publish create image.png">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>不多时就构建好了</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/deep_publish_result.png" alt="deep publish result.png">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
更详细的说明见： <a href="https://docs.docker.com/docker-hub/github/" class="bare">https://docs.docker.com/docker-hub/github/</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--19"><a class="anchor" href="#true--19"></a>9. 网络</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Docker的很多问题都是网络设置引发的，所以这里有必要介绍一下Docker的网络处理。</p>
</div>
<div class="paragraph">
<p>在容器运行时Docker提供了<code>--net</code>参数来指定容器的网络，它有四种选项：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>--net=bridge</code> 这是默认选项，会为容器分配独立的网络环境</p>
</li>
<li>
<p><code>--net=host</code> 让容器使用宿主机的网络环境，<strong>注意</strong> 这意味着放弃了容器的网络隔离，它让容器可以访问宿主机的权限，不推荐使用</p>
</li>
<li>
<p><code>--net=container:NAME_or_ID</code> 让容器与另一个容器共用网络环境，这样的话两者就可以相互通信</p>
</li>
<li>
<p><code>--net=none</code> Docker不去管理容器的网络，用户可以自定义容器的网络设置，这选项自由度最高</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--20"><a class="anchor" href="#true--20"></a>10. 生态系统</h2>
<div class="sectionbody">
<div class="paragraph">
<p>随着Docker如火如荼地发展，它的应用场景也越来越广泛，群众的想像力是无限的，这导致了Docker本身的功能往往无法满足人们凶残的需求，所以产生了一大堆的扩展应用，Docker与这些扩展应用、“寄生”公司相辅相成，共同发展。</p>
</div>
<div class="paragraph">
<p>下面介绍几个不错的扩展</p>
</div>
<div class="sect2">
<h3 id="truedocker-toolbox"><a class="anchor" href="#truedocker-toolbox"></a>10.1. Docker Toolbox</h3>
<div class="paragraph">
<p>请您在Windows下使用Docker，实际上就是安装了个Visual Box ~~</p>
</div>
<div class="paragraph">
<p><a href="https://www.docker.com/docker-toolbox" class="bare">https://www.docker.com/docker-toolbox</a></p>
</div>
</div>
<div class="sect2">
<h3 id="truekitematic"><a class="anchor" href="#truekitematic"></a>10.2. Kitematic</h3>
<div class="paragraph">
<p>Docker官方推荐的GUI工具</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ecosys_kitematic.png" alt="ecosys kitematic.png">
</div>
</div>
<div class="paragraph">
<p><a href="https://kitematic.com/" class="bare">https://kitematic.com/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="truepipework"><a class="anchor" href="#truepipework"></a>10.3. pipework</h3>
<div class="paragraph">
<p>一个功能多多的网络扩展工具包</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/jpetazzo/pipework" class="bare">https://github.com/jpetazzo/pipework</a></p>
</div>
</div>
<div class="sect2">
<h3 id="truedocker-swarm"><a class="anchor" href="#truedocker-swarm"></a>10.4. Docker Swarm</h3>
<div class="paragraph">
<p>让Docker运行在多个宿主机上</p>
</div>
<div class="paragraph">
<p><a href="http://docs.docker.com/swarm/install-w-machine/" class="bare">http://docs.docker.com/swarm/install-w-machine/</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--21"><a class="anchor" href="#true--21"></a>11. 热点问题</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true-ip"><a class="anchor" href="#true-ip"></a>11.1. 容器如何使用静态IP</h3>
<div class="paragraph">
<p>默认情况下Docker容器的IP是动态分配的，要使用静态IP时我们会思考一下：</p>
</div>
<div class="paragraph">
<p>为什么需要静态IP？如果是为了两个容器间通信可以</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>使用<code>--link</code></p>
</li>
<li>
<p>指定<code>-h</code>来指定hostname并指定<code>-dns</code>到宿主机</p>
</li>
<li>
<p>让容器开放上层服务</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>如果这样都满足不了您的要求那么可以参考 <a href="http://huataihuang.github.io/2014/10/05/docker-container-static-ip/" class="bare">http://huataihuang.github.io/2014/10/05/docker-container-static-ip/</a> 此文实现</p>
</div>
</div>
<div class="sect2">
<h3 id="true-a-id-qanda-add-port-to-alive-container-a"><a class="anchor" href="#true-a-id-qanda-add-port-to-alive-container-a"></a>11.2. 如何为运行中的容器增加访问端口<a id="qanda-add-port-to-alive-container"></a></h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">iptables -t nat -A  DOCKER -p tcp --dport &lt;外部映射端口&gt; -j DNAT --to-destination &lt;宿主机IP&gt;:&lt;容器新加的端口&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://stackoverflow.com/questions/19897743/exposing-a-port-on-a-live-docker-container" class="bare">http://stackoverflow.com/questions/19897743/exposing-a-port-on-a-live-docker-container</a></p>
</div>
</div>
<div class="sect2">
<h3 id="true-docker-ip"><a class="anchor" href="#true-docker-ip"></a>11.3. 让Docker容器使用静态独立的外部IP（便于集群组建）</h3>
<div class="paragraph">
<p>需要使用Docker虚拟化Hadoop/Spark等测试环境，并且要可以对外提供服务，要求是完全分布式的部署（尽量模拟生产环境）。那么我们会遇到几个问题：</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Container IP 是动态分配的</p>
</li>
<li>
<p>Container IP 是内部IP，外部无法访问（如对外提供HDFS服务可能会遇到Client无法访问DataNode，因为DataNode注册的是内部IP）</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>针对第一个问题有不少的方案，可以指定静态的IP，对第二个问题，我们可以使用--net=host解决，但这会导致对外只有一个IP，集群各个Slave的端口都要修改。至于pipework简单地看了下，好像也解决不了。</p>
</div>
<div class="paragraph">
<p>所以目前看上去只能使用看上去不是很优雅的方案解决:*<strong>为Docker宿主网卡绑定多个IP，把这些IP分配给不同的容器。</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash" data-lang="bash">//这是示例，我是在windows下用Docker toolbox运行的
root@default:~# ifconfig
docker0   Link encap:Ethernet  HWaddr 02:42:8C:8E:80:F1
          inet addr:172.17.42.1  Bcast:0.0.0.0  Mask:255.255.0.0
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

eth0      Link encap:Ethernet  HWaddr 08:00:27:24:D1:F5
          inet addr:10.0.2.15  Bcast:10.0.2.255  Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fe24:d1f5/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:222 errors:0 dropped:0 overruns:0 frame:0
          TX packets:164 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:32277 (31.5 KiB)  TX bytes:28136 (27.4 KiB)

eth1      Link encap:Ethernet  HWaddr 08:00:27:76:1D:9B
          inet addr:192.168.99.100  Bcast:192.168.99.255  Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fe76:1d9b/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:66 errors:0 dropped:0 overruns:0 frame:0
          TX packets:64 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:9001 (8.7 KiB)  TX bytes:10469 (10.2 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:16 errors:0 dropped:0 overruns:0 frame:0
          TX packets:16 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:1152 (1.1 KiB)  TX bytes:1152 (1.1 KiB)

//eth1网卡是可以与外部交互，所以我们添加IP到这个网卡上
//第一步：添加了两个IP
root@default:~# ifconfig eth1:0 192.168.99.10 netmask 255.255.255.0 up
root@default:~# ifconfig eth1:1 192.168.99.11 netmask 255.255.255.0 up
//再次查看，多了两个IP
root@default:~# ifconfig
...

eth1      Link encap:Ethernet  HWaddr 08:00:27:76:1D:9B
          inet addr:192.168.99.100  Bcast:192.168.99.255  Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fe76:1d9b/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2258 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1685 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:207033 (202.1 KiB)  TX bytes:209587 (204.6 KiB)

eth1:0    Link encap:Ethernet  HWaddr 08:00:27:76:1D:9B
          inet addr:192.168.99.10  Bcast:192.168.99.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

eth1:1    Link encap:Ethernet  HWaddr 08:00:27:76:1D:9B
          inet addr:192.168.99.11  Bcast:192.168.99.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
...

//第二步：运行容器，指定IP，这里的示例容器开启的SSH服务，后面拿它测试
root@default:~# docker run -d -p 192.168.99.10:222:22 --name ssh1 gudaoxuri/scala-2.11-env
root@default:~# docker run -d -p 192.168.99.11:222:22 --name ssh2 gudaoxuri/scala-2.11-env
root@default:~# docker ps
CONTAINER ID        IMAGE                      COMMAND               CREATED             STATUS              PORTS                       NAMES
ab024af9c954        gudaoxuri/scala-2.11-env   "/usr/sbin/sshd -D"   4 seconds ago       Up 3 seconds        192.168.99.11:222-&gt;22/tcp   ssh2
259351134d16        gudaoxuri/scala-2.11-env   "/usr/sbin/sshd -D"   15 seconds ago      Up 14 seconds       192.168.99.10:222-&gt;22/tcp   ssh1

//测试连接，在Docker宿主机上SSH到第一个容器
root@default:~# ssh 192.168.99.10 -p222
The authenticity of host '[192.168.99.10]:222 ([192.168.99.10]:222)' can't be established.
RSA key fingerprint is ac:fe:4b:89:f8:51:b7:e9:9c:34:62:f9:80:38:4b:bf.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[192.168.99.10]:222' (RSA) to the list of known hosts.
root@192.168.99.10's password:
Last login: Wed Oct  7 13:12:35 2015 from 192.168.99.1
//成功进入
[root@259351134d16 ~]#
//在第一个容器中SSH到第二个容器
[root@259351134d16 ~]# ssh 192.168.99.11 -p222
root@192.168.99.11's password:
Last login: Wed Oct  7 13:14:53 2015 from 172.17.42.1
//也OK了
[root@ab024af9c954 ~]#</code></pre>
</div>
</div>
<div class="paragraph">
<p>参考我的Blog <a href="http://my.oschina.net/gudaoxuri/blog/513923" class="bare">http://my.oschina.net/gudaoxuri/blog/513923</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--22"><a class="anchor" href="#true--22"></a>12. 附</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Docker文档</div>
<p><a href="https://docs.docker.com/" class="bare">https://docs.docker.com/</a></p>
</div>
<div class="paragraph">
<div class="title">Docker实战案例视频课程</div>
<p>此课程很不错，推荐 <a href="http://edu.51cto.com/course/course_id-4238.html" class="bare">http://edu.51cto.com/course/course_id-4238.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--23"><a class="anchor" href="#true--23"></a>13. 索引</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0<br>
Last updated 2015-11-07 07:40:16
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>